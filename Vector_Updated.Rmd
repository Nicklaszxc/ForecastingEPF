---
title: "BVAR and VAR"
output: html_document
---

###############
## LOAD DATA ## 
###############

#load the data :) Data from 2017-2022
```{r}
library(readxl)
library(forecast)
data <- read_excel("/Users/nicklasschmidt/Downloads/Master thesis/Dataset/EnergyDataset2017-2022.xlsx", 
    col_types = c("date", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric"))
data = na.omit(data)
str(data)
```
```{r}
library(strucchange)
Ts = ts(data[,2:7], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )
TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

bp_ts = breakpoints(TsDK1 ~ 1)
summary(bp_ts)
```

##############################
## Granger Causality test   ##
##############################
```{r}
library(lmtest)
#perform Granger-Causality test
grangertest(DK1 ~ gasPrice, order = 7, data = TsDiff)
grangertest(DK1 ~ DK2, order = 7, data = TsDiff)
grangertest(DK1 ~ dkTemp, order = 7, data = TsDiff)
grangertest(DK1 ~ dkWind, order = 7, data = TsDiff)
grangertest(DK1 ~ nwRain, order = 7, data = TsDiff)
```




##############################
## 2019 all months VectorAR ##
##############################
```{r}
library(vars)
Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,2:7], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )


#Subsetting train and test data using window()function 
month2019train = window(Ts, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)


# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test)[2,1:6]


 
accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```


##############################
## 2021 all months VectorAR ##
##############################
```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,2:6], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

#Subsetting train and test data using window()function 
month2019train = window(Ts,start=c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables])) 
month2019test = window(TsDK1, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

____________________________________________________

#Differenced
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,2:7], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,2:7], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```



```{r}
summary(data)
```
```{r}
library(tseries)
head(Ts[])
```
```{r}
#DK1
adf.test(x = window(Ts[,1], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,1], start =c(2017, 1),  end = c(2022, 1)))
```
```{r}
#DK2
adf.test(x = window(Ts[,2], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,2], start =c(2017, 1),  end = c(2022, 1)))
```
```{r}
#GasPrice
adf.test(x = window(Ts[,3], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,3], start =c(2017, 1),  end = c(2022, 1)))
```
```{r}
#DKTemp
adf.test(x = window(Ts[,4], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,4], start =c(2017, 1),  end = c(2022, 1)))
```
```{r}
#DKWind
adf.test(x = window(Ts[,5], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,5], start =c(2017, 1),  end = c(2022, 1)))
```
```{r}
#NWRAIN
adf.test(x = window(Ts[,6], start =c(2017, 1),  end = c(2021, 1)))
adf.test(x = window(Ts[,6], start =c(2017, 1),  end = c(2022, 1)))
```



```{r}
adf.test(x = diff(data$DK1))
adf.test(x = diff(data$DK2))
adf.test(x = diff(data$gasPrice))
adf.test(x = diff(data$dkTemp))
adf.test(x = diff(data$dkWind))
adf.test(x = diff(data$nwRain))
```

#Differenced without dkTemp
#2019 Diff
```{r}
library(vars)
library(Metrics)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:4,6:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:4]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:4]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:4]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:4]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:4]


#Model building, with 1 year plus to febuary
month2019test1 = window(naivedec, start = c(Year, MonthNumber[MonthVariables]), end = c(Year,1+MonthNumber[MonthVariables]))
month2019test7 = window(naivedec, start = c(Year, MonthNumber[MonthVariables]), end = c(Year,7+MonthNumber[MonthVariables]))
month2019test14 = window(naivedec, start = c(Year, MonthNumber[MonthVariables]), end = c(Year,14+MonthNumber[MonthVariables]))
month2019test21 = window(naivedec, start = c(Year, MonthNumber[MonthVariables]), end = c(Year,21+MonthNumber[MonthVariables]))
month2019test28 = window(naivedec, start = c(Year, MonthNumber[MonthVariables]), end = c(Year,28+MonthNumber[MonthVariables]))

forecast1 <- c(month2019test1[-length(month2019test1)])
forecast7 <- c(month2019test7[-length(month2019test7)])
forecast14 <- c(month2019test14[-length(month2019test14)])
forecast21 <- c(month2019test21[-length(month2019test21)])
forecast28 <- c(month2019test28[-length(month2019test28)])

naivemae1=mae(month2019test1[2:nrow(month2019test1),],forecast1)
naivemae7=mae(month2019test7[2:nrow(month2019test7),],forecast7)
naivemae14=mae(month2019test14[2:nrow(month2019test14),],forecast14)
naivemae21=mae(month2019test21[2:nrow(month2019test21),],forecast21)
naivemae28=mae(month2019test28[2:nrow(month2019test28),],forecast28)

rMAE1 = decna1[4] / naivemae1
rMAE7 = decna7[4] / naivemae7
rMAE14 = decna14[4] / naivemae14
rMAE21 = decna21[4] / naivemae21
rMAE28 = decna28[4] / naivemae28


accuracytable = rbind(c(decna1,rMAE1),c(decna7,rMAE7),c(decna14,rMAE14),c(decna21,rMAE21),c(decna28,rMAE28))

#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")
colnames(naivetable) = c("Month", "me","RMSE", "MAE","MPE", "MAPE","MASE","rMAE")


if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))


}
#subset DK1 
FebruaryTable[,c(3,4,5,6,7,8)]
JulyTable[,c(3,4,5,6,7,8)]
SeptemberTable[,c(3,4,5,6,7,8)]
DecemberTable[,c(3,4,5,6,7,8)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MAPEtable = cbind(as.numeric(FebruaryTable[,5]),as.numeric(JulyTable[,5]),as.numeric(SeptemberTable[,5]),as.numeric(DecemberTable[,5]))
rownames(MAPEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAPEtable) = c("February","July","September","December")
AverageMAPEtable = rowMeans(MAPEtable)
AverageMAPEtable

MAPEtable = cbind(as.numeric(FebruaryTable[,6]),as.numeric(JulyTable[,6]),as.numeric(SeptemberTable[,6]),as.numeric(DecemberTable[,6]))
rownames(MAPEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAPEtable) = c("February","July","September","December")
AverageMAPEtable = rowMeans(MAPEtable)
AverageMAPEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

rMAEtable = cbind(as.numeric(FebruaryTable[,8]),as.numeric(JulyTable[,8]),as.numeric(SeptemberTable[,8]),as.numeric(DecemberTable[,8]))
rownames(rMAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(rMAEtable) = c("February","July","September","December")
AveragerMAEtable = rowMeans(rMAEtable)
AveragerMAEtable
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:4,6:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```


#Differenced without East Denmark Price
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:2,4:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:2,4:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

#Differenced without Norway Rain
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:6)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:6)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

#Differenced without Gas
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:3,5:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:3,5:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

#Differenced without Wind
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:5,7:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:5,7:7)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

#Differenced without Wind and Rain
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:5)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:5)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

#Differenced with only DK1, DK2, and Gas
#2019 Diff
```{r}
library(vars)

Year = 2019
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:3,4:4)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```

```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,c(2:3,4:4)], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]

accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1Diff, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```


#this is yikes jo?
#Differenced and log transfromed
#2019 Diff
```{r}
library(vars)

Year = 2021
Month = c("February", "July", "September", "December")
MonthNumber = c(32, 182, 244, 335)

for(MonthVariables in 1:4){
# First we convert dataset into a time series object
Ts = ts(data[,2:7], start = c(2017,1), frequency = 365 )
TsDK1 = ts(data[,2:2], start = c(2017,1), frequency = 365 )

head(Ts)

Ts[,1] = log(Ts[,1]+15)
Ts[,2] = log(Ts[,2]+15)

head(exp(Ts[,1:2])-15)

TsDiff = diff(Ts, lag = 1)
TsDK1Diff = diff(TsDK1, lag = 1)

invdiffdata = diffinv(x = TsDiff[,1],lag = 1,differences = 1,xi = Ts[1,1])
head(exp(invdiffdata)-15)

#Subsetting train and test data using window()function 
month2019train = window(TsDiff, start = c(Year-2, MonthNumber[MonthVariables]), end = c(Year, MonthNumber[MonthVariables]))
month2019test = window(TsDK1Diff, start = c(Year, MonthNumber[MonthVariables]))
logmonth2019test = window(Ts, start = c(Year, MonthNumber[MonthVariables]))

#Models estimating.
var.model = VAR(month2019train, p = 7, type = 'both', season = 365)

#Forecasting for 1-28 days 
model1dec2019=forecast(var.model, h=1)
model7dec2019=forecast(var.model, h=7)
model14dec2019=forecast(var.model, h=14)
model21dec2019=forecast(var.model, h=21)
model28dec2019=forecast(var.model, h=28)

model1dec2019$forecast$DK1$mean = diffinv(x = model1dec2019$forecast$DK1$mean,lag = 1,differences = 1,xi = logmonth2019test[1,1])
model7dec2019$forecast$DK1$mean= diffinv(x = model7dec2019$forecast$DK1$mean,lag = 1,differences = 1,xi = logmonth2019test[1,1])
model14dec2019$forecast$DK1$mean= diffinv(x = model14dec2019$forecast$DK1$mean,lag = 1,differences = 1,xi = logmonth2019test[1,1])
model21dec2019$forecast$DK1$mean= diffinv(x = model21dec2019$forecast$DK1$mean,lag = 1,differences = 1,xi = logmonth2019test[1,1])
model28dec2019$forecast$DK1$mean= diffinv(x = model28dec2019$forecast$DK1$mean,lag = 1,differences = 1,xi = logmonth2019test[1,1])

model1dec2019$forecast$DK1$mean= exp(model1dec2019$forecast$DK1$mean)-15
model7dec2019$forecast$DK1$mean=exp(model7dec2019$forecast$DK1$mean)-15
model14dec2019$forecast$DK1$mean= exp(model14dec2019$forecast$DK1$mean)-15
model21dec2019$forecast$DK1$mean= exp(model21dec2019$forecast$DK1$mean)-15
model28dec2019$forecast$DK1$mean= exp(model28dec2019$forecast$DK1$mean)-15

# Accuracy TABLE
decna1=forecast::accuracy(object = model1dec2019$forecast$DK1, x= month2019test, d=1, D=0)[2,1:6]
decna7=forecast::accuracy(object = model7dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna14=forecast::accuracy(object = model14dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna21=forecast::accuracy(object = model21dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]
decna28=forecast::accuracy(object = model28dec2019$forecast$DK1,x= month2019test, d=1, D=0)[2,1:6]


accuracytable = rbind(decna1,decna7,decna14,decna21,decna28)
#plot table
naivetable = cbind(Month[MonthVariables],accuracytable)
rownames(naivetable) = c("Point","7 days","14 days","21 days","28 days")

if (MonthVariables == 1) {FebruaryTable = naivetable}
if (MonthVariables == 2) {JulyTable = naivetable}
if (MonthVariables == 3) {SeptemberTable = naivetable}
if (MonthVariables == 4) {DecemberTable = naivetable}

naivetsplot = window(TsDK1, start = c(Year, 1),end = c(Year + 1,1))
prettyplot = autoplot(naivetsplot, xlab = "Year", ylab = "Electricity price in DK1 area", main="Vector AR plot, h=1,7,14,21,28")+autolayer(model28dec2019$forecast$DK1, series = "28 Days", PI = FALSE, size = 1)+autolayer(model21dec2019$forecast$DK1, series = "21 Days", PI = FALSE, size = 1)+autolayer(model14dec2019$forecast$DK1, series = "14 Days", PI = FALSE, size = 1)+autolayer(model7dec2019$forecast$DK1, series = "7 Days", PI = FALSE, size = 1)+autolayer(model1dec2019$forecast$DK1, series = "Days point", PI = FALSE, size = 1)
assign(paste0("prettyplot",MonthVariables),prettyplot)

}
#subset DK1 
FebruaryTable[,c(3,4,7)]
JulyTable[,c(3,4,7)]
SeptemberTable[,c(3,4,7)]
DecemberTable[,c(3,4,7)]

RMSEtable = cbind(as.numeric(FebruaryTable[,3]),as.numeric(JulyTable[,3]),as.numeric(SeptemberTable[,3]),as.numeric(DecemberTable[,3]))
rownames(RMSEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(RMSEtable) = c("February","July","September","December")
AverageRMSEtable = rowMeans(RMSEtable)
AverageRMSEtable

MAEtable = cbind(as.numeric(FebruaryTable[,4]),as.numeric(JulyTable[,4]),as.numeric(SeptemberTable[,4]),as.numeric(DecemberTable[,4]))
rownames(MAEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MAEtable) = c("February","July","September","December")
AverageMAEtable = rowMeans(MAEtable)
AverageMAEtable

MASEtable = cbind(as.numeric(FebruaryTable[,7]),as.numeric(JulyTable[,7]),as.numeric(SeptemberTable[,7]),as.numeric(DecemberTable[,7]))
rownames(MASEtable) = c("Point","7 days","14 days","21 days","28 days")
colnames(MASEtable) = c("February","July","September","December")
AverageMASEtable = rowMeans(MASEtable)
AverageMASEtable

prettyplot1
prettyplot2
prettyplot3
prettyplot4
```





